# 🎯 封面图片功能测试指南

## ⚡ 快速测试步骤

### 步骤1：清除缓存
```
按 F12 → 右键刷新按钮 → "清空缓存并硬性重新加载"
```

### 步骤2：访问编辑页面
```
http://localhost:8080/admin/articles/2/edit
登录: admin / admin
```

### 步骤3：测试从图片库选择
```
1. 点击"从图片库选择"按钮
2. ✅ 应该看到: 图片网格模态框弹出
3. 点击任意图片
4. ✅ 应该看到: 模态框关闭，封面预览显示
5. 点击"保存文章"
6. ✅ 应该看到: 保存成功
```

### 步骤4：测试上传新封面（小图片）
```
1. 点击"上传新封面"按钮
2. 选择一个 <500KB 的图片文件
3. ✅ 应该看到: 封面预览显示
4. 点击"保存文章"
5. ✅ 应该看到: 保存成功
```

### 步骤5：测试上传新封面（大图片）
```
1. 点击"上传新封面"按钮
2. 选择一个 >500KB 的图片文件
3. ✅ 应该看到: 弹出错误提示
   "❌ 封面图片过大！
   上传新封面的图片必须小于 500KB"
4. ✅ 应该看到: 不会导致414错误
```

### 步骤6：测试移除封面
```
1. 如果有封面预览，点击"移除封面"按钮
2. ✅ 应该看到: 封面预览消失
3. 保存文章
4. ✅ 应该看到: 文章无封面
```

## 🔍 控制台调试

打开开发者工具（F12 → Console），观察日志：

### 正常日志示例
```
✅ showCoverImagePicker 被调用
✅ showImagePickerModal 被调用，图片数量: 1
✅ 选择了图片: /static/uploads/images/xxx.jpg
✅ 准备调用 setCoverImage
✅ setCoverImage 被调用
✅ 检测到服务器图片，去掉 /static/ 前缀保存
✅ setCoverImage 执行完成
✅ 模态框已关闭
```

### 上传新封面日志
```
✅ uploadNewCoverImage 被调用
✅ 文件已选择: filename.jpg 123456
✅ 图片读取完成，准备设置封面
✅ setCoverImage 被调用
✅ 检测到Base64图片，直接保存
✅ setCoverImage 执行完成
```

## 🎯 预期结果

### ✅ 成功标志
- [x] 模态框正常弹出
- [x] 图片列表正常显示
- [x] 点击图片后模态框关闭
- [x] 封面预览正确显示
- [x] 保存后数据正确
- [x] 无JavaScript错误

### ❌ 错误标志
- [ ] 点击按钮无反应
- [ ] 模态框卡住不动
- [ ] 控制台有红色错误
- [ ] 保存时出现414错误
- [ ] 封面预览不显示

## 📊 大小建议

| 类型 | 推荐大小 | 最大限制 |
|------|----------|----------|
| 上传新封面 | <300KB | 500KB |
| 图片库图片 | <2MB | 无限制 |
| 封面显示尺寸 | 1200×630 | - |

## 💡 最佳实践

1. **小图片**（<500KB）：直接上传新封面
2. **大图片**（>500KB）：
   - 先上传到图片管理
   - 再从图片库选择
3. **封面尺寸**：1200×630像素（16:9）
4. **文件格式**：JPG或PNG

## 🚨 如有问题

请提供：
1. 浏览器Console的完整日志
2. 具体的错误信息
3. 哪一步没有按预期工作

---

**立即测试：清除缓存 → 访问编辑页 → 测试封面功能！** 🚀

*更新时间: 2025-10-28 10:22*