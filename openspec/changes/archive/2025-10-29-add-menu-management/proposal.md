# 提案：为首页添加动态菜单管理功能

## Why

当前CMS的导航菜单采用硬编码实现，这导致了以下问题：

1. **灵活性不足**：管理员无法通过后台界面动态添加或修改导航菜单，每次修改都需要编辑HTML模板
2. **维护成本高**：菜单结构调整需要开发人员介入，无法自助完成
3. **功能局限**：无法实现多级菜单、条件显示、高级排序等高级功能
4. **扩展性差**：随着业务发展，菜单需求会不断变化，硬编码方式难以适应

动态菜单管理系统将提供：
- ✅ 可视化管理界面，管理员可独立操作
- ✅ 支持拖拽排序、图标设置、层级管理
- ✅ 完整的CRUD操作和权限控制
- ✅ 为未来功能扩展奠定基础（多语言、权限控制等）

**业务价值：**
- 提升管理员工作效率
- 降低技术维护成本
- 增强系统灵活性和可扩展性
- 改善用户体验

## What Changes

实现一个完整的动态菜单管理系统，包括：

1. **新增数据库模型**：在 `models.py` 中添加 `MenuItem` 模型，支持层级菜单结构
2. **新增API端点**：在 `app.py` 中实现6个菜单管理API端点
3. **新增管理界面**：创建 `templates/admin/menu_management.html` 菜单管理页面
4. **修改前端模板**：更新 `templates/base.html` 使用动态菜单渲染
5. **新增初始化功能**：自动创建默认菜单项（首页、文章、视频、图片）
6. **新增上下文处理器**：为所有模板自动注入菜单数据
7. **更新文档**：在 `CLAUDE.md` 中添加菜单管理功能说明

## 变更概述

当前CMS的导航菜单在 `templates/base.html` 中硬编码实现，用户无法通过管理后台动态添加、编辑或删除菜单项。本提案旨在实现一个完整的动态菜单管理系统。

## 问题陈述

**现状：**
- 导航菜单硬编码在HTML模板中
- 无法通过管理界面修改菜单
- 菜单结构固定：首页、文章、视频、图片、管理后台
- 缺少灵活性，无法支持自定义页面或外链

**痛点：**
1. 管理员无法快速添加新的导航项目
2. 无法重新排序菜单项
3. 无法管理菜单图标和显示名称
4. 无法创建下拉菜单结构
5. 缺少菜单可见性控制

## 解决方案

实现一个完整的菜单管理系统，包含：

1. **数据库模型**：创建 `MenuItem` 模型存储菜单数据
2. **管理界面**：在admin后台添加菜单管理页面
3. **前端渲染**：修改base.html从数据库动态加载菜单
4. **功能特性**：
   - 菜单项CRUD操作
   - 拖拽排序
   - 支持图标选择
   - 下拉菜单支持
   - 启用/禁用控制

## 技术实现要点

### 数据库设计
- `MenuItem` 表：存储菜单项信息
- 支持层级结构（parent-child关系）
- 字段：label、url、icon、order、visible、parent_id

### 核心功能
1. 菜单项管理（增删改查）
2. 拖拽排序
3. 图标选择器
4. 层级菜单渲染
5. 前端模板集成

### 兼容性
- 保持现有设计风格
- 兼容Bootstrap 5
- 不破坏现有功能

## 预期收益

1. **灵活性**：管理员可完全自定义导航菜单
2. **易用性**：通过可视化界面管理菜单
3. **可维护性**：集中化管理，易于维护
4. **扩展性**：支持未来功能扩展（下拉菜单、多级菜单等）

## 风险评估

- **数据迁移**：需要创建默认菜单项
- **模板兼容性**：需确保前端模板正确渲染
- **性能**：菜单查询应优化

## 里程碑

- [ ] 创建MenuItem数据模型
- [ ] 实现菜单管理API
- [ ] 开发管理界面
- [ ] 修改前端模板
- [ ] 创建默认菜单数据
- [ ] 测试验证

## 相关文档

- 数据库模型设计：见 `design.md`
- 实施任务清单：见 `tasks.md`
- 现有导航实现：`templates/base.html:121-159`
- 管理后台结构：`templates/admin/base.html`

---

**作者：** Claude Code
**创建时间：** 2025-10-29
**状态：** 待审核
