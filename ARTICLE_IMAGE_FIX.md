# ğŸ“ æ–‡ç« å›¾ç‰‡ä¸Šä¼ é—®é¢˜ä¿®å¤æŠ¥å‘Š

## ğŸ› é—®é¢˜æè¿°
**ç—‡çŠ¶**: ä¿å­˜å¸¦æœ‰å›¾ç‰‡çš„æ–‡ç« æ—¶å‡ºç°é”™è¯¯
```
Request Entity Too Large
The data value transmitted exceeds the capacity limit.
```

**æ ¹æœ¬åŸå› **:
- Quillç¼–è¾‘å™¨ä¸­çš„å›¾ç‰‡è¢«è½¬æ¢ä¸ºBase64ç¼–ç åµŒå…¥åˆ°HTMLä¸­
- å¤§å›¾ç‰‡çš„Base64ç¼–ç å¤§å¤§å¢åŠ äº†HTTPè¯·æ±‚å¤§å°
- å¤šä¸ªå¤§å›¾ç‰‡ä¼šå¯¼è‡´è¯·æ±‚è¶…è¿‡æœåŠ¡å™¨é™åˆ¶

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ğŸ” åç«¯é˜²æŠ¤æªæ–½

#### 1. **è¯·æ±‚å¤§å°é¢„æ£€æŸ¥**
```python
@app.before_request
def before_request():
    if request.method == 'POST':
        # æ£€æŸ¥Content-Length
        content_length = request.headers.get('Content-Length')
        if content_length:
            length = int(content_length)
            max_length = 50 * 1024 * 1024  # 50MB
            if length > max_length:
                abort(413)  # Payload Too Large
```

#### 2. **Base64å›¾ç‰‡å¤§å°æ£€æŸ¥**
```python
def check_base64_images(content):
    # æŸ¥æ‰¾æ‰€æœ‰Base64å›¾ç‰‡
    base64_pattern = r'data:image/[^;]+;base64,[A-Za-z0-9+/=]+'
    matches = re.findall(base64_pattern, content)

    # æ£€æŸ¥å•ä¸ªå›¾ç‰‡å¤§å° (< 500KB)
    # æ£€æŸ¥æ€»å›¾ç‰‡å¤§å° (< 2MB)
```

### ğŸ¨ å‰ç«¯ä¼˜åŒ–

#### 1. **è‡ªå®šä¹‰å›¾ç‰‡æ’å…¥å¯¹è¯æ¡†**
- ä¼˜å…ˆæ¨èä½¿ç”¨å›¾ç‰‡URLé“¾æ¥
- æ–‡ä»¶ä¸Šä¼ é™åˆ¶ < 500KB
- æ¸…æ™°çš„ä½¿ç”¨æç¤º

#### 2. **å®æ—¶å›¾ç‰‡å¤§å°ç›‘æ§**
- ç¼–è¾‘æ—¶å®æ—¶æ£€æµ‹Base64å›¾ç‰‡å¤§å°
- è¶…è¿‡1MBæ—¶æ§åˆ¶å°è­¦å‘Š
- æäº¤å‰å…¨é¢æ£€æŸ¥

#### 3. **ç”¨æˆ·å‹å¥½æç¤º**
- å›¾ç‰‡ä½¿ç”¨å»ºè®®å¡ç‰‡
- ç¼–è¾‘å™¨å ä½ç¬¦æç¤º
- é”™è¯¯ä¿¡æ¯è¯¦ç»†è¯´æ˜

---

## ğŸ“Š é™åˆ¶å‚æ•°

| é¡¹ç›® | é™åˆ¶å€¼ | è¯´æ˜ |
|------|--------|------|
| å•ä¸ªBase64å›¾ç‰‡ | 500KB | è¶…è¿‡é™åˆ¶ä¼šé˜»æ­¢æäº¤ |
| æ–‡ç« ä¸­å›¾ç‰‡æ€»å¤§å° | 2MB | æ€»è®¡è¶…è¿‡ä¼šè­¦å‘Š |
| HTTPè¯·æ±‚å¤§å° | 50MB | æœåŠ¡å™¨é™åˆ¶ |
| æ–‡ä»¶ä¸Šä¼ å¤§å° | 1GB | å›¾ç‰‡ç®¡ç†åŠŸèƒ½ |

---

## ğŸ¯ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•
1. **å°å›¾ç‰‡ (< 500KB)**: ç›´æ¥åœ¨ç¼–è¾‘å™¨ä¸­æ’å…¥
2. **å¤§å›¾ç‰‡**: ä¸Šä¼ åˆ°"å›¾ç‰‡ç®¡ç†"ï¼Œæ–‡ç« ä¸­æ’å…¥é“¾æ¥
3. **å¤–éƒ¨å›¾ç‰‡**: ä½¿ç”¨CDNæˆ–å¤–éƒ¨é“¾æ¥
4. **å›¾ç‰‡ä¼˜åŒ–**: å‹ç¼©åå†ä¸Šä¼ 

### âŒ é¿å…åšæ³•
1. ç›´æ¥ç²˜è´´å¤§å›¾ç‰‡ï¼ˆ> 500KBï¼‰
2. å¤šä¸ªBase64å¤§å›¾
3. é«˜åˆ†è¾¨ç‡æœªå‹ç¼©å›¾ç‰‡
4. é‡å¤ä¸Šä¼ ç›¸åŒå›¾ç‰‡

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. Base64å¤§å°è®¡ç®—
```python
base64_data = match.split(',')[1]
decoded_size = len(base64_data) * 3 / 4  # Base64è§£ç åå¤§å°
```

### 2. å®æ—¶ç›‘æ§
```javascript
quill.on('text-change', function() {
    const base64Matches = content.match(/data:image\/[^;]+;base64,[A-Za-z0-9+/=]+/g);
    if (base64Matches) {
        // è®¡ç®—å¹¶æ£€æŸ¥æ€»å¤§å°
    }
});
```

### 3. é¢„æäº¤æ£€æŸ¥
```javascript
function checkArticleImages() {
    // æ£€æŸ¥å•ä¸ªå›¾ç‰‡å¤§å°
    // æ£€æŸ¥æ€»å›¾ç‰‡å¤§å°
    // è¿”å›éªŒè¯ç»“æœ
}
```

---

## ğŸ“± ç”¨æˆ·æ“ä½œæµç¨‹

### æ’å…¥å°å›¾ç‰‡
1. åœ¨ç¼–è¾‘å™¨ä¸­ç‚¹å‡»å›¾ç‰‡æŒ‰é’®
2. é€‰æ‹© < 500KB çš„å›¾ç‰‡æ–‡ä»¶
3. ç›´æ¥æ’å…¥ï¼ˆè‡ªåŠ¨è½¬ä¸ºBase64ï¼‰

### æ’å…¥å¤§å›¾ç‰‡
1. è¿›å…¥"å›¾ç‰‡ç®¡ç†"
2. ä¸Šä¼ å¤§å›¾ç‰‡
3. å¤åˆ¶å›¾ç‰‡URL
4. åœ¨ç¼–è¾‘å™¨ä¸­æ’å…¥å›¾ç‰‡é“¾æ¥

---

## ğŸ¨ ç•Œé¢æ”¹è¿›

### æ–‡ç« ç¼–è¾‘å™¨
- âœ… æ·»åŠ å›¾ç‰‡ä½¿ç”¨å»ºè®®å¡ç‰‡
- âœ… è‡ªå®šä¹‰å›¾ç‰‡æ’å…¥å¯¹è¯æ¡†
- âœ… å®æ—¶æ–‡ä»¶å¤§å°æ˜¾ç¤º
- âœ… è¯¦ç»†é”™è¯¯æç¤º

### æç¤ºä¿¡æ¯
```
ğŸ’¡ æç¤ºï¼šä¸Šä¼ å¤§å›¾ç‰‡è¯·ä½¿ç”¨å›¾ç‰‡ç®¡ç†åŠŸèƒ½ï¼Œç„¶ååœ¨æ–‡ç« ä¸­æ’å…¥å›¾ç‰‡é“¾æ¥

âœ… æ¨èåšæ³•ï¼š
â€¢ å¤§å›¾ç‰‡ä¸Šä¼ åˆ°"å›¾ç‰‡ç®¡ç†"
â€¢ æ–‡ç« ä¸­æ’å…¥å›¾ç‰‡é“¾æ¥
â€¢ Base64å›¾ç‰‡ < 500KB
â€¢ æ–‡ç« æ€»å›¾ç‰‡ < 2MB

âŒ é¿å…ï¼š
â€¢ ç›´æ¥ç²˜è´´å¤§å›¾ç‰‡
â€¢ å¤šä¸ªBase64å¤§å›¾
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. å‡å°‘æ•°æ®ä¼ è¾“
- Base64å›¾ç‰‡ vs å¤–éƒ¨é“¾æ¥
- å…¸å‹å¤§å°å¯¹æ¯”ï¼š
  - Base64ç¼–ç : 1MBå›¾ç‰‡ â†’ ~1.3MB
  - å¤–éƒ¨é“¾æ¥: 1MBå›¾ç‰‡ â†’ å‡ åå­—èŠ‚

### 2. é¡µé¢åŠ è½½é€Ÿåº¦
- å°æ–‡ç« æ›´å¿«åŠ è½½
- å‡å°‘å¸¦å®½å ç”¨
- æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### åœºæ™¯1ï¼šæŠ€æœ¯åšå®¢æ–‡ç« 
- å°æˆªå›¾ï¼šç›´æ¥ç²˜è´´
- å¤§å›¾ï¼šä¸Šä¼ åé“¾æ¥
- ä»£ç æˆªå›¾ï¼šæ¨èå¤–éƒ¨é“¾æ¥

### åœºæ™¯2ï¼šå›¾ç‰‡å±•ç¤ºæ–‡ç« 
- ç¼©ç•¥å›¾ï¼šç›´æ¥æ’å…¥
- é«˜æ¸…å¤§å›¾ï¼šä½¿ç”¨å¤–éƒ¨CDN
- å›¾é›†ï¼šæ‰¹é‡ä¸Šä¼ åˆ°å›¾ç‰‡ç®¡ç†

### åœºæ™¯3ï¼šæ•™ç¨‹æ–‡æ¡£
- å°å›¾æ ‡ï¼šç›´æ¥æ’å…¥
- æ­¥éª¤æˆªå›¾ï¼šå‹ç¼©åæ’å…¥
- å®Œæ•´ç•Œé¢ï¼šé“¾æ¥æ–¹å¼

---

## ğŸ” æ•…éšœæ’é™¤

### Q: ä»ç„¶æç¤º"Request Entity Too Large"
**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. æ–‡ç« ä¸­æ˜¯å¦æœ‰è¶…å¤§Base64å›¾ç‰‡
2. ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®š
3. æµè§ˆå™¨æ˜¯å¦ç¼“å­˜äº†æ—§ç‰ˆæœ¬

### Q: å¦‚ä½•æŸ¥æ‰¾æ–‡ç« ä¸­çš„å¤§å›¾ç‰‡
**A**:
1. ç¼–è¾‘æ–‡ç« 
2. æŸ¥çœ‹æ§åˆ¶å°è­¦å‘Š
3. æˆ–æ‰‹åŠ¨æ£€æŸ¥HTMLæºç ä¸­çš„Base64

### Q: å¯ä»¥è°ƒæ•´é™åˆ¶å—
**A**: ä¿®æ”¹ `app.py` ä¸­çš„å‚æ•°ï¼š
```python
max_single_size = 500 * 1024  # å•ä¸ªå›¾ç‰‡é™åˆ¶
if total_size > 2 * 1024 * 1024:  # æ€»å›¾ç‰‡é™åˆ¶
```

---

## âœ… æµ‹è¯•éªŒè¯

### æµ‹è¯•æ¡ˆä¾‹
1. âœ… æ’å…¥ < 500KB å›¾ç‰‡ - æˆåŠŸ
2. âœ… æ’å…¥ > 500KB å›¾ç‰‡ - é˜»æ­¢å¹¶æç¤º
3. âœ… å¤šä¸ªå°å›¾ç‰‡æ€» < 2MB - æˆåŠŸ
4. âœ… å¤šä¸ªå°å›¾ç‰‡æ€» > 2MB - è­¦å‘Š
5. âœ… æ’å…¥å›¾ç‰‡URL - æˆåŠŸ
6. âœ… å¤§å›¾ç‰‡ä¸Šä¼ åˆ°ç®¡ç† - æˆåŠŸ

### éªŒè¯æ–¹æ³•
```bash
# æµ‹è¯•API
curl http://localhost:8080/api/articles

# æ£€æŸ¥å‰ç«¯
è®¿é—® http://localhost:8080/admin/articles/new
```

---

## ğŸ‰ ä¿®å¤å®Œæˆ

**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•

**åº”ç”¨åœ°å€**:
- å‰å°: http://localhost:8080
- åå°: http://localhost:8080/admin/login

**ç°åœ¨å¯ä»¥å®‰å…¨åœ°åˆ›å»ºåŒ…å«å›¾ç‰‡çš„æ–‡ç« äº†ï¼** ğŸš€

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `UPLOAD_FIX.md` - æ–‡ä»¶ä¸Šä¼ ä¿®å¤æŠ¥å‘Š
- `README.md` - å®Œæ•´ä½¿ç”¨è¯´æ˜
- `GITHUB_SYNC.md` - GitHubåŒæ­¥æŒ‡å—

---

## ğŸ’¡ å»ºè®®

å¯¹äºç”Ÿäº§ç¯å¢ƒï¼Œå»ºè®®ï¼š
1. ä½¿ç”¨CDNå­˜å‚¨å›¾ç‰‡
2. å›¾ç‰‡å‹ç¼©å’Œä¼˜åŒ–
3. å®šæœŸæ¸…ç†æœªä½¿ç”¨çš„å›¾ç‰‡
4. ç›‘æ§ç³»ç»Ÿå­˜å‚¨ç©ºé—´
5. ä½¿ç”¨å¯¹è±¡å­˜å‚¨ï¼ˆå¦‚AWS S3ï¼‰
